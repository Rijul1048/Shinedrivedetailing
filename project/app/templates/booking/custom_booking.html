{% extends "layout.html" %}
{% load static %}
{% block content %}

<div class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 pb-12 px-4 sm:px-6 lg:px-8 pt-20 md:pt-40">
    <div class="max-w-4xl mx-auto">
        <!-- Progress Indicator -->
        <div class="flex justify-center mb-12 px-4">
            <div class="flex flex-col md:flex-row items-center w-full max-w-md md:max-w-none">
                <!-- Step 1 -->
                <div class="flex items-center mb-4 md:mb-0 relative">
                    <div class="w-10 h-10 rounded-full bg-[#AC87C5] flex items-center justify-center text-white font-bold shadow-md z-10">
                        1
                    </div>
                    <div class="ml-3 text-sm md:text-base font-medium text-gray-700 whitespace-nowrap">Vehicle Selected</div>
                </div>
                
                <!-- Connector 1 -->
                <div class="hidden md:block w-24 h-1 bg-gradient-to-r from-[#AC87C5] to-[#756AB6] mx-2"></div>
                <div class="md:hidden h-8 w-1 bg-gradient-to-b from-[#AC87C5] to-[#756AB6] my-1"></div>
                
                <!-- Step 2 -->
                <div class="flex items-center mb-4 md:mb-0 relative">
                    <div class="w-10 h-10 rounded-full bg-[#AC87C5] flex items-center justify-center text-white font-bold shadow-md z-10">
                        2
                    </div>
                    <div class="ml-3 text-sm md:text-base font-medium text-gray-700 whitespace-nowrap">Choose Service</div>
                </div>
                
                <!-- Connector 2 -->
                <div class="hidden md:block w-24 h-1 bg-gradient-to-r from-[#AC87C5] to-[#756AB6] mx-2"></div>
                <div class="md:hidden h-8 w-1 bg-gradient-to-b from-[#AC87C5] to-[#756AB6] my-1"></div>
                
                <!-- Step 3 -->
                <div class="flex items-center relative">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-[#756AB6] to-[#AC87C5] flex items-center justify-center text-white font-bold shadow-lg ring-2 ring-[#756AB6] ring-offset-2 z-10">
                        3
                    </div>
                    <div class="ml-3 text-sm md:text-base font-bold text-[#756AB6] whitespace-nowrap">Book Appointment</div>
                </div>
            </div>
        </div>  
        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-[#4b4188ff] to-[#5f52a9] mb-4">
                Book Your Detailing Service
            </h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                Complete your booking details below to schedule your premium automotive care
            </p>
        </div>

<!-- Booking Card Container -->
<div class="bg-white rounded-xl shadow-xl overflow-hidden transition-all duration-300 hover:shadow-2xl mb-12">
<div class="md:flex">
<!-- Booking Form Section -->
<div class="w-full p-6 md:p-8">
  <!-- Store the booking URL in a data attribute -->
  <div id="bookingUrl" data-url="{% url 'booking' %}" style="display: none;"></div>
  
  <form id="bookingForm" method="POST" action="{% url 'booking' %}" class="space-y-8" novalidate>
    {% csrf_token %}
    {% if form.non_field_errors %}
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
        <strong class="font-bold">Error!</strong>
        <span class="block sm:inline">{{ form.non_field_errors }}</span>
      </div>
    {% endif %}
    
    <!-- Selection Summary Card -->
    <div class="bg-indigo-50 p-6 rounded-xl border border-indigo-100 mb-8 transition-colors duration-200 hover:border-indigo-200">
      <div class="flex items-center mb-4">
        <svg class="w-6 h-6 text-indigo-600 mr-3" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1  00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 04-4z" clip-rule="evenodd"></path>
        </svg>
        <h2 class="text-xl font-bold text-indigo-800">Your Selection</h2>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-5">
        <!-- Vehicle Selection -->
        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100 hover:border-indigo-200 transition-colors">
          <p class="text-sm text-gray-500 mb-1">Vehicle</p>
          <select id="vehicleDropdown" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white">
            <option value="sedan">Sedan/Coupe (2 Seats)</option>
            <option value="suv5">SUV (5 Seats)</option>
            <option value="suv7">Pick Up/7-Seat SUV</option>
            <option value="xlsuv">XL SUV</option>
          </select>
          {{ form.vehicle_type.as_hidden }}
          {% if form.vehicle_type.errors %}
            <p class="text-red-500 text-xs italic mt-1">{{ form.vehicle_type.errors }}</p>
          {% endif %}
        </div>
        
        <!-- Service Selection -->
        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100 hover:border-indigo-200 transition-colors">
          <p class="text-sm text-gray-500 mb-1">Service</p>
          <select id="serviceDropdown" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white">
            <option value="full">Full Detail</option>
            <option value="interior">Interior Detail</option>
            <option value="exterior">Exterior Detail</option>
          </select>
          {{ form.service_type.as_hidden }}
          {% if form.service_type.errors %}
            <p class="text-red-500 text-xs italic mt-1">{{ form.service_type.errors }}</p>
          {% endif %}
        </div>
        
        <!-- Package Selection -->
        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100 hover:border-indigo-200 transition-colors">
          <p class="text-sm text-gray-500 mb-1">Package</p>
          <select id="packageDropdown" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white">
            <!-- Options will be populated dynamically -->
          </select>
          {{ form.package_type.as_hidden }}
          <input type="hidden" id="packagePrice" name="package_price">
          {% if form.package_type.errors %}
            <p class="text-red-500 text-xs italic mt-1">{{ form.package_type.errors }}</p>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Personal Information Section -->
    <div class="space-y-6">
      <h2 class="text-2xl font-bold text-gray-800 pb-2 border-b border-gray-200 flex items-center">
        <svg class="w-6 h-6 text-gray-700 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
        Your Information
      </h2>
      
      <!-- Full Name Field -->
      <div class="form-group">
        <label for="{{ form.full_name.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
          Full Name <span class="text-red-500">*</span>
        </label>
        <div class="relative">
          {{ form.full_name }}
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 03z" clip-rule="evenodd"></path>
            </svg>
          </div>
        </div>
        {% if form.full_name.errors %}
          <p class="text-red-500 text-xs italic mt-1">{{ form.full_name.errors }}</p>
        {% endif %}
      </div>
      
      <!-- Contact Information Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Mobile Number -->
        <div class="form-group">
          <label for="{{ form.mobile.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
            Mobile Number <span class="text-red-500">*</span>
          </label>
          <div class="relative">
            {{ form.mobile }}
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"></path>
              </svg>
            </div>
          </div>
          {% if form.mobile.errors %}
            <p class="text-red-500 text-xs italic mt-1">{{ form.mobile.errors }}</p>
          {% endif %}
        </div>
        
        <!-- Email Address -->
        <div class="form-group">
          <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
            Email Address
          </label>
          <div class="relative">
            {{ form.email }}
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
              </svg>
            </div>
          </div>
          {% if form.email.errors %}
            <p class="text-red-500 text-xs italic mt-1">{{ form.email.errors }}</p>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Scheduling Section -->
    <div class="space-y-6">
      <h2 class="text-2xl font-bold text-gray-800 pb-2 border-b border-gray-200 flex items-center">
        <svg class="w-6 h-6 text-gray-700 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
        </svg>
        Schedule Your Appointment
      </h2>
      
      <div class="grid grid-cols-1 gap-6">
        <!-- Date Picker -->
        <div class="form-group">
          <label for="{{ form.date.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
            Date <span class="text-red-500">*</span>
          </label>
          <div class="relative">
            {{ form.date }}
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path>
              </svg>
            </div>
          </div>
          {% if form.date.errors %}
            <p class="text-red-500 text-xs italic mt-1">{{ form.date.errors }}</p>
          {% endif %}
        </div>

      </div>
    </div>

    <!-- Special Requests -->
    <div class="form-group">
      <label for="{{ form.special_requests.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
        Special Requests
      </label>
      <div class="relative">
        {{ form.special_requests }}
        <div class="absolute top-3 left-3">
          <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
            <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"></path>
          </svg>
        </div>
      </div>
      {% if form.special_requests.errors %}
        <p class="text-red-500 text-xs italic mt-1">{{ form.special_requests.errors }}</p>
      {% endif %}
    </div>

    <!-- Order Summary & Submit -->
    <div class="bg-indigo-50 p-6 rounded-xl border border-indigo-100 mt-8 transition-colors duration-200 hover:border-indigo-200">
      <h2 class="text-xl font-bold text-indigo-800 mb-5 flex items-center">
        <svg class="w-5 h-5 text-indigo-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 2a4 4 0 00- 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1  00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z" clip-rule="evenodd"></path>
        </svg>
        Order Summary
      </h2>
      
      <div class="space-3 mb-6">
        <div class="flex justify-between">
          <span class="text-gray-600">Service:</span>
          <span class="font-medium text-gray-800" id="summaryService"></span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-600">Vehicle:</span>
          <span class="font-medium text-gray-800" id="summaryVehicle"></span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-600">Duration:</span>
          <span class="font-medium text-gray-800" id="summaryDuration"></span>
        </div>
        <div class="flex justify-between border-t border-gray-200 pt-3 mt-3">
          <span class="text-gray-800 font-bold">Total:</span>
          <div class="text-indigo-600 font-medium text-sm"><span class="text-indigo-700 font-bold text-lg" id="summaryTotal"></span>+HST</div>
          
        </div>
      </div>
      
      <button type="submit" class="w-full bg-gradient-to-r from-[#4b4188ff] to-[#5f52a9] hover:from-[#6f62c4] hover:to-[#7268ae] text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-[1.01] focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center justify-center">
        <svg class="w-5 h-5 text-white mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
        Confirm Booking
      </button>
    </div>
  </form>
</div>
</div>
</div>
    </div>
</div>

<script>
  // Get the booking URL from the data attribute
  const bookingUrl = document.getElementById('bookingUrl').getAttribute('data-url');
  
  // Pricing data
  const pricing = {
      'sedan': {
          'full': {
              'bronze_full': { display: 'Bronze Full Detail ($136 CAD)', price: '136', duration: '1-2 hours' },
              'gold_full': { display: 'Gold Full Detail ($195 CAD)', price: '195', duration: '2-3 hours' },
              'platinum_full': { display: 'Platinum Full Detail ($217 CAD)', price: '217', duration: '3-4 hours' }
          },
          'interior': {
              'bronze_interior': { display: 'Bronze Interior Detail ($110 CAD)', price: '110', duration: '1-1.5 hours' },
              'gold_interior': { display: 'Gold Interior Detail ($165 CAD)', price: '165', duration: '1.5-2.5 hours' },
              'platinum_interior': { display: 'Platinum Interior Detail ($186 CAD)', price: '186', duration: '2-3 hours' }
          },
          'exterior': {
              'gold_exterior': { display: 'Gold Exterior Detail ($163 CAD)', price: '163', duration: '1-1.5 hours' },
              'platinum_exterior': { display: 'Premium Exterior Detail ($200 CAD)', price: '200', duration: '1.5-2 hours' }
          }
      },
      'suv5': {
          'full': {
              'bronze_full': { display: 'Bronze Full Detail ($171 CAD)', price: '171', duration: '1.5-2.5 hours' },
              'gold_full': { display: 'Gold Full Detail ($217 CAD)', price: '217', duration: '2.5-3.5 hours' },
              'platinum_full': { display: 'Platinum Full Detail ($244 CAD)', price: '244', duration: '3.5-4.5 hours' }
          },
          'interior': {
              'bronze_interior': { display: 'Bronze Interior Detail ($137 CAD)', price: '137', duration: '1.5-2 hours' },
              'gold_interior': { display: 'Gold Interior Detail ($180 CAD)', price: '180', duration: '2-2.5 hours' },
              'platinum_interior': { display: 'Platinum Interior Detail ($208 CAD)', price: '208', duration: '2.5-3.5 hours' }
          },
          'exterior': {
              'gold_exterior': { display: 'Gold Exterior Detail ($181 CAD)', price: '181', duration: '1-2 hours' },
              'platinum_exterior': { display: 'Premium Exterior Detail ($228 CAD)', price: '228', duration: '1.5-2.5 hours' }
          }
      },
      'suv7': {
          'full': {
              'bronze_full': { display: 'Bronze Full Detail ($204 CAD)', price: '204', duration: '2-3 hours' },
              'gold_full': { display: 'Gold Full Detail ($258 CAD)', price: '258', duration: '3-4 hours' },
              'platinum_full': { display: 'Platinum Full Detail ($285 CAD)', price: '285', duration: '4-5 hours' }
          },
          'interior': {
              'bronze_interior': { display: 'Bronze Interior Detail ($154 CAD)', price: '154', duration: '2-2.5 hours' },
              'gold_interior': { display: 'Gold Interior Detail ($208 CAD)', price: '208', duration: '2.5-3 hours' },
              'platinum_interior': { display: 'Platinum Interior Detail ($235 CAD)', price: '235', duration: '3-4 hours' }
          },
          'exterior': {
              'gold_exterior': { display: 'Gold Exterior Detail ($200 CAD)', price: '200', duration: '1.5-2 hours' },
              'platinum_exterior': { display: 'Premium Exterior Detail ($250 CAD)', price: '250', duration: '2-2.5 hours' }
          }
      },
      'xlsuv': {
          'full': {
              'bronze_full': { display: 'Bronze Full Detail ($213 CAD)', price: '213', duration: '2.5-3.5 hours' },
              'gold_full': { display: 'Gold Full Detail ($267 CAD)', price: '267', duration: '3.5-4.5 hours' },
              'platinum_full': { display: 'Platinum Full Detail ($294 CAD)', price: '294', duration: '4.5-6 hours' }
          },
          'interior': {
              'bronze_interior': { display: 'Bronze Interior Detail ($163 CAD)', price: '163', duration: '2.5-3 hours' },
              'gold_interior': { display: 'Gold Interior Detail ($217 CAD)', price: '217', duration: '3-3.5 hours' },
              'platinum_interior': { display: 'Platinum Interior Detail ($244 CAD)', price: '244', duration: '3.5-4.5 hours' }
          },
          'exterior': {
              'gold_exterior': { display: 'Gold Exterior Detail ($213 CAD)', price: '213', duration: '2-2.5 hours' },
              'platinum_exterior': { display: 'Premium Exterior Detail ($286 CAD)', price: '286', duration: '2.5-3 hours' }
          }
      }
  };
  
  // Default packages for each service type
  const defaultPackages = {
      'full': 'gold_full',
      'interior': 'gold_interior',
      'exterior': 'platinum_exterior'
  };
  
  // Map between URL parameter values and form field values
  const packageValueMap = {
      'bronze_full': 'bronze',
      'gold_full': 'gold',
      'platinum_full': 'platinum',
      'bronze_interior': 'bronze',
      'gold_interior': 'gold', 
      'platinum_interior': 'platinum',
      'gold_exterior': 'gold',
      'platinum_exterior': 'platinum'
  };
  
  document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM loaded - testing script execution');
      
      // Initialize form with URL parameters
      const urlParams = new URLSearchParams(window.location.search);
      const vehicleType = urlParams.get('vehicle') || 'sedan';
      const serviceType = urlParams.get('service') || 'full';
      const packageType = urlParams.get('package') || defaultPackages[serviceType];
      
      console.log('Initial parameters:', {vehicleType, serviceType, packageType});
      
      // Set dropdown values
      const vehicleDropdown = document.getElementById('vehicleDropdown');
      const serviceDropdown = document.getElementById('serviceDropdown');
      
      if (vehicleDropdown) vehicleDropdown.value = vehicleType;
      if (serviceDropdown) serviceDropdown.value = serviceType;
      
      // Update hidden form fields
      document.getElementById('id_vehicle_type').value = vehicleType;
      document.getElementById('id_service_type').value = serviceType;
      
      // Populate package dropdown based on initial values
      populatePackageDropdown(vehicleType, serviceType, packageType);
      
      // Update display based on initial values
      updatePackageDisplay(vehicleType, serviceType, packageType);
      updateSummary(vehicleType, serviceType, packageType);
      
      // Set minimum date to today
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('id_date').min = today;
      
      // Add event listeners to dropdowns
      document.getElementById('vehicleDropdown').addEventListener('change', function() {
          console.log('Vehicle dropdown changed');
          const vehicle = this.value;
          const service = document.getElementById('serviceDropdown').value;
          const defaultPackage = defaultPackages[service];
          
          console.log('Redirecting to:', `${bookingUrl}?vehicle=${vehicle}&service=${service}&package=${defaultPackage}`);
          
          // Update hidden form field
          document.getElementById('id_vehicle_type').value = vehicle;
          
          // Reload page with new parameters
          window.location.href = `${bookingUrl}?vehicle=${vehicle}&service=${service}&package=${defaultPackage}`;
      });
      
      document.getElementById('serviceDropdown').addEventListener('change', function() {
          console.log('Service dropdown changed');
          const service = this.value;
          const vehicle = document.getElementById('vehicleDropdown').value;
          const defaultPackage = defaultPackages[service];
          
          console.log('Redirecting to:', `${bookingUrl}?vehicle=${vehicle}&service=${service}&package=${defaultPackage}`);
          
          // Update hidden form field
          document.getElementById('id_service_type').value = service;
          
          // Reload page with new parameters
          window.location.href = `${bookingUrl}?vehicle=${vehicle}&service=${service}&package=${defaultPackage}`;
      });
      
      document.getElementById('packageDropdown').addEventListener('change', function() {
          console.log('Package dropdown changed');
          const packageValue = this.value;
          const vehicle = document.getElementById('vehicleDropdown').value;
          const service = document.getElementById('serviceDropdown').value;
          
          console.log('Updating package to:', packageValue);
          
          // Update the display without reloading
          updatePackageDisplay(vehicle, service, packageValue);
          updateSummary(vehicle, service, packageValue);
      });
  });
  
  function populatePackageDropdown(vehicleType, serviceType, selectedPackage) {
      const packageDropdown = document.getElementById('packageDropdown');
      if (!packageDropdown) {
          console.error('Package dropdown not found');
          return;
      }
      
      packageDropdown.innerHTML = '';
      
      const packages = pricing[vehicleType]?.[serviceType] || {};
      
      for (const [key, value] of Object.entries(packages)) {
          const option = document.createElement('option');
          option.value = key;
          option.textContent = value.display;
          if (key === selectedPackage) {
              option.selected = true;
          }
          packageDropdown.appendChild(option);
      }
      
      // If the selected package doesn't exist in the new options, select the first one
      if (!packages[selectedPackage] && Object.keys(packages).length > 0) {
          const firstPackage = Object.keys(packages)[0];
          packageDropdown.value = firstPackage;
          updatePackageDisplay(vehicleType, serviceType, firstPackage);
          updateSummary(vehicleType, serviceType, firstPackage);
      }
  }
  
  function updatePackageDisplay(vehicleType, serviceType, packageType) {
      const packageInfo = getPackageInfo(vehicleType, serviceType, packageType);
      
      const packageTypeElement = document.getElementById('id_package_type');
      if (packageTypeElement) {
          // Map the package type to what your form expects
          packageTypeElement.value = packageValueMap[packageType] || packageType;
      }
      
      const packagePriceElement = document.getElementById('packagePrice');
      if (packagePriceElement) {
          packagePriceElement.value = packageInfo.price;
      }
  }
  
  function getPackageInfo(vehicleType, serviceType, packageType) {
      return pricing[vehicleType]?.[serviceType]?.[packageType] || pricing['sedan']['full']['gold_full'];
  }
  
  function updateSummary(vehicleType, serviceType, packageType) {
      const packageInfo = getPackageInfo(vehicleType, serviceType, packageType);
      const vehicleDisplayMap = {
          'sedan': 'Sedan/Coupe (2 Seats)',
          'suv5': 'SUV (5 Seats)',
          'suv7': 'Pick Up/7-Seat SUV',
          'xlsuv': 'XL SUV'
      };
      
      const summaryService = document.getElementById('summaryService');
      const summaryVehicle = document.getElementById('summaryVehicle');
      const summaryDuration = document.getElementById('summaryDuration');
      const summaryTotal = document.getElementById('summaryTotal');
      
      if (summaryService) summaryService.textContent = packageInfo.display.split(' (')[0];
      if (summaryVehicle) summaryVehicle.textContent = vehicleDisplayMap[vehicleType];
      if (summaryDuration) summaryDuration.textContent = packageInfo.duration;
      if (summaryTotal) summaryTotal.textContent = `$${packageInfo.price} CAD`;
  }
</script>

{% endblock %}